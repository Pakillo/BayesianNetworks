<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bayesian Modelling of Bipartite Networks • BayesianWebs</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Modelling of Bipartite Networks">
<meta name="description" content="Bayesian modelling of bipartite network structure, following the approach of Young et al. &lt;doi:10.1038/s41467-021-24149-x&gt;.">
<meta property="og:description" content="Bayesian modelling of bipartite network structure, following the approach of Young et al. &lt;doi:10.1038/s41467-021-24149-x&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">BayesianWebs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Pakillo/BayesianWebs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bayesianwebs">BayesianWebs<a class="anchor" aria-label="anchor" href="#bayesianwebs"></a>
</h1></div>
<!-- badges: start -->

<p>The BayesianWebs R package facilitates modelling bipartite networks (like pollination, frugivory, or herbivory networks) using the Bayesian framework developed by <a href="https://doi.org/10.1038/s41467-021-24149-x" class="external-link">Young et al. (2021)</a>.</p>
<p>Inferring the structure of bipartite networks from field (observational) data is a challenging task. Interaction data are hard to collect and require typically large sampling efforts, particularly to characterize infrequent interactions. Inferred network structure is highly sensitive to sampling design, effort, and completeness. Comparing networks from different studies without accounting for these sampling effects may lead to mistaken inferences.</p>
<p>This package uses Bayesian modelling to infer the posterior probability of each pairwise interaction in bipartite networks, accounting for sampling completeness and the inherent stochasticity of field observation data.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of BayesianWebs from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Pakillo/BayesianWebs"</span><span class="op">)</span></span></code></pre></div>
<p>The package requires a working installation of <a href="https://mc-stan.org/" class="external-link">Stan</a>. If you don’t have <code>CmdStan</code> installed, after installing <code>BayesianWebs</code> run:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">cmdstanr</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/cmdstanr/reference/install_cmdstan.html" class="external-link">install_cmdstan</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pakillo.github.io/BayesianWebs/">BayesianWebs</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s infer the structure of an example dataset from <a href="https://doi.org/10.1038/nature21071" class="external-link">Kaiser-Bunbury et al. 2017</a> as in Young et al. 2021:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">web</span><span class="op">)</span></span></code></pre></div>
<p>This is an adjacency matrix collecting the number of visits of 21 animals on 8 plants:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">web</span></span>
<span><span class="co">#&gt;    A1 A2 A3 A4 A5 A6 A7 A8 A9 A10 A11 A12 A13 A14 A15 A16 A17 A18 A19 A20 A21</span></span>
<span><span class="co">#&gt; P1  0  0  3  1  0  0  0  0  0   0   0   0   0   4   0   0   0   0   0   0   0</span></span>
<span><span class="co">#&gt; P2  0  0 12  0  0  0  0  0  0   0   0   0   0   8   0   1   0   0   0   0   1</span></span>
<span><span class="co">#&gt; P3  0  0  0  0  1  0  7  0  0   0   0   0   0   2   0   0   5   3   0   0   0</span></span>
<span><span class="co">#&gt; P4  0  0  2  0  3  0  0  1  0   0   0   0   0  30   0   0   0   0   0   0   0</span></span>
<span><span class="co">#&gt; P5  0  0  0  0  0  0  0  0  0   0   0   0   0   1   0   0   0   0   1   0   0</span></span>
<span><span class="co">#&gt; P6  0  0  0  4  1  0  1  0  0   0   1   5   2   0   0   0   0   0   0   0   0</span></span>
<span><span class="co">#&gt; P7  3  0 33  0  0  2  6  0  2   0   0   0   0  27   0   0   0   0   0   0   2</span></span>
<span><span class="co">#&gt; P8  0  1  1  1  2  0 11  0  0   6   0   0   0   1   2   0   0   0   0   1   0</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_counts_obs.html">plot_counts_obs</a></span><span class="op">(</span><span class="va">web</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<p>First, prepare the data for modelling. Here we assume constant sampling effort among plants:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prepare_data.html">prepare_data</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">web</span>, sampl.eff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">web</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now fit the model. There are several models available: the original model used in Young et al. (2021), a model that takes into account varying sampling effort among plants, and a model that allows for varying preferences among animals. The user can also provide a customised Stan model. See <code><a href="reference/fit_model.html">fit_model()</a></code>.</p>
<p>Here we run 4 parallel chains:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">dt</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running MCMC with 4 parallel chains...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chain 1 finished in 2.9 seconds.</span></span>
<span><span class="co">#&gt; Chain 4 finished in 2.9 seconds.</span></span>
<span><span class="co">#&gt; Chain 2 finished in 3.0 seconds.</span></span>
<span><span class="co">#&gt; Chain 3 finished in 3.1 seconds.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All 4 chains finished successfully.</span></span>
<span><span class="co">#&gt; Mean chain execution time: 2.9 seconds.</span></span>
<span><span class="co">#&gt; Total execution time: 3.4 seconds.</span></span></code></pre></div>
<p>Check model:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/check_model.html">check_model</a></span><span class="op">(</span><span class="va">fit</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing csv files: /tmp/Rtmpq9vAYS/sampling_effort-202412172000-1-400f5e.csv, /tmp/Rtmpq9vAYS/sampling_effort-202412172000-2-400f5e.csv, /tmp/Rtmpq9vAYS/sampling_effort-202412172000-3-400f5e.csv, /tmp/Rtmpq9vAYS/sampling_effort-202412172000-4-400f5e.csv</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking sampler transitions treedepth.</span></span>
<span><span class="co">#&gt; Treedepth satisfactory for all transitions.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking sampler transitions for divergences.</span></span>
<span><span class="co">#&gt; No divergent transitions found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Checking E-BFMI - sampler transitions HMC potential energy.</span></span>
<span><span class="co">#&gt; E-BFMI satisfactory.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Effective sample size satisfactory.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Split R-hat values satisfactory all parameters.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Processing complete, no problems detected.</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="100%"><img src="reference/figures/README-unnamed-chunk-7-2.png" width="100%"></p>
<p>Get the posteriors:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_posterior.html">get_posterior</a></span><span class="op">(</span><span class="va">fit</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">post</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 11</span></span>
<span><span class="co">#&gt; # Groups:   Plant, Animal [6]</span></span>
<span><span class="co">#&gt;   Plant Animal .chain .iteration .draw connectance preference plant.abund</span></span>
<span><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;      &lt;int&gt; &lt;int&gt;       &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 P1    A1          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; 2 P1    A2          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; 3 P1    A3          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; 4 P1    A4          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; 5 P1    A5          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; 6 P1    A6          1          1     1       0.299       33.0      0.0185</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: animal.abund &lt;dbl&gt;, int.prob &lt;dbl&gt;, link &lt;int&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_interaction_prob.html">plot_interaction_prob</a></span><span class="op">(</span><span class="va">post</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="100%"></p>
<p>Predict interaction counts:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/predict_counts.html">predict_counts</a></span><span class="op">(</span><span class="va">fit</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/plot_counts_pred.html">plot_counts_pred</a></span><span class="op">(</span><span class="va">pred.df</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="100%"></p>
<p>Compare observed and predicted counts:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_counts_pred_obs.html">plot_counts_pred_obs</a></span><span class="op">(</span><span class="va">pred.df</span>, data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="100%"></p>
<p>Plot residuals:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_residuals.html">plot_residuals</a></span><span class="op">(</span><span class="va">pred.df</span>, data <span class="op">=</span> <span class="va">dt</span>, sort <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>BayesianWebs</code> please cite it:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">citation</span>(<span class="st">"BayesianWebs"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>If you use BayesianWebs, please cite both Young et <span class="fu">al.</span> (<span class="dv">2021</span>) and the</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>package as<span class="sc">:</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  Young J, Valdovinos F, Newman <span class="fu">M</span> (<span class="dv">2021</span>). <span class="st">"Reconstruction of</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="st">  plant–pollinator networks from observational data."</span> _Nature</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  Communications_, <span class="sc">*</span><span class="dv">12</span><span class="sc">*</span>, <span class="fl">3911.</span> doi<span class="sc">:</span><span class="fl">10.1038</span><span class="sc">/</span>s41467<span class="dv">-021-24149</span><span class="sc">-</span>x</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>doi.org<span class="sc">/</span><span class="fl">10.1038</span><span class="sc">/</span>s41467<span class="dv">-021-24149</span><span class="sc">-</span>x<span class="sc">&gt;</span>.</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>  Rodriguez<span class="sc">-</span>Sanchez <span class="fu">F</span> (<span class="dv">2024</span>). _BayesianWebs<span class="sc">:</span> Bayesian Modelling of</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  Bipartite Networks_. <span class="sc">&lt;</span>https<span class="sc">:</span><span class="er">//</span>pakillo.github.io<span class="sc">/</span>BayesianWebs<span class="sc">/</span><span class="er">&gt;</span>.</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>To see these entries <span class="cf">in</span> BibTeX format, use <span class="st">'print(&lt;citation&gt;,</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="st">bibtex=TRUE)'</span>, <span class="st">'toBibtex(.)'</span>, or set</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="st">'options(citation.bibtex.max=999)'</span>.</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Pakillo/BayesianWebs/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Pakillo/BayesianWebs/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing BayesianWebs</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Francisco Rodriguez-Sanchez <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7981-1599" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Pakillo/BayesianWebs/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Pakillo/BayesianWebs/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://hits.dwyl.com/Pakillo/BayesianWebs" class="external-link"><img src="https://hits.dwyl.com/Pakillo/BayesianWebs.svg?style=flat-square" alt="HitCount"></a></li>
<li><a href="https://hits.dwyl.com/Pakillo/BayesianWebs" class="external-link"><img src="https://hits.dwyl.com/Pakillo/BayesianWebs.svg?style=flat-square&amp;show=unique" alt="HitCount"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francisco Rodriguez-Sanchez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
